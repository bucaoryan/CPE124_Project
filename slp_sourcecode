import RPi.GPIO as GPIO
import time
from time import sleep
import csv

GPIO.setmode(GPIO.BCM)
GPIO.setwarnings(False)
GPIO.setup(20, GPIO.IN) #pir for alcohol

Relay_1_GPIO = 23 #alcohol
#float = 3 #float switch

GPIO.setup(Relay_1_GPIO, GPIO.OUT)
#GPIO.setup(float, GPIO.OUT)
#GPIO.setup(float, GPIO.IN, GPIO.PUD_DOWN) #float switch
#GPIO.setup(float, GPIO.OUT, initial=GPIO.HIGH)

count = 0
#date_log = []
measurement_ml = 450
number_of_pumps = 0

while True:
    if number_of_pumps <= measurement_ml:
        print("FULL")
        j = GPIO.input(20)
        if j==0:
            print("no hand")
            #GPIO.output(Relay_1_GPIO, GPIO.LOW)
        elif j==1:
            print("SYSTEM ACTIVATED")
            #date_log.append(time.ctime())
            GPIO.output(Relay_1_GPIO, GPIO.HIGH)
            time.sleep(1)
            GPIO.output(Relay_1_GPIO, GPIO.LOW)
            count +=1
            number_of_pumps += 15
            current_date_time = time.ctime()
            with open('systemlog.csv', 'a+', newline='') as file:
                writer = csv.writer(file)
                writer.writerow(["ACTIVATED", current_date_time, "LIBRARY"])
        #time.sleep(3)
    else:
        print("EMPTY")
        time.sleep(5)
